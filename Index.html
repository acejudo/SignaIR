<!--
    Adrián Cejudo Ruiz
    acejudoruiz@gmail.com
    acejudoruiz.ddns.net
    reference: http://www.asp.net/signalr/overview/getting-started/tutorial-getting-started-with-signalr
    test
-->

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>SignalIr</title>
</head>
<body>
    <!-- Latest compiled and minified CSS -->
    <link href="Content/css/bootstrap.min.css" rel="stylesheet" />
  
    <!-- Optional theme -->
    <link href="Content/css/bootstrap-theme.min.css" rel="stylesheet" />

    <!--Script references. -->
   
    <!--Reference the jQuery library. -->
    <script src="Scripts/jquery-1.10.2.min.js"></script>
    <!--Reference the SignalR library. -->
    <script src="Scripts/jquery.signalR-2.1.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="signalr/hubs"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="Content/js/bootstrap.min.js"></script>  

    <nav class="navbar navbar-default" role="navigation">
        <!-- El logotipo y el icono que despliega el menú se agrupan
             para mostrarlos mejor en los dispositivos móviles -->
        <div class="navbar-header">
            <a class="navbar-brand" href="#">SignaIr</a>
        </div>

        <!-- Agrupar los enlaces de navegación, los formularios y cualquier
             otro elemento que se pueda ocultar al minimizar la barra -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">


            <form class="navbar-form navbar-left" role="search">
                <div class="form-group">
                    <input type="text" id="notificaction" class="form-control" placeholder="Notification" />
                </div>
                <input type="button" id="sendNotification" class="btn btn-default" value="Send Notification" />
            </form>

            <form class="navbar-form navbar-right" role="search">
                <span class="glyphicon glyphicon-bell"></span><label id="count">0</label>
            </form>
</div>
    </nav>


    <div class="container">
        <table id="resultNotifications" class="table table-bordered">
            <thead>
                <tr>
                    <td>
                        Notifications:
                    </td>
                </tr>
            </thead>
           
        </table>
    </div>


  
    <!--Add script to update the page and send messages.-->
    <script type="text/javascript">
        $(function () {
            // Declare a proxy to reference the hub.
            var signalHub = $.connection.signalHub;
            var count = parseInt($('#count').text());
            // Create a function that the hub can call to broadcast messages.
            signalHub.client.broadcastMessage = function (notification) {
                // Add the message to the page.
                $('#resultNotifications').append('<tr><td>' + notification
                    + '</td></tr>');
                count = count + 1;
                $('#count').text(count);
            };
            // Set initial focus to message input box.
            $('#notificaction').focus();
            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#sendNotification').click(function () {
                    // Call the Send method on the hub.
                    signalHub.server.sendNotification($('#notificaction').val());
                    // Clear text box and reset focus for next comment.
                    $('#notificaction').val('').focus();
                });
            });
        });
    </script>
</body>
</html>
